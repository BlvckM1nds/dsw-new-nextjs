generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model User {
  // example ID: UDS-wd9a01dk
  id           String   @id @db.VarChar(16)
  firstName    String
  lastName     String?
  email        String   @unique
  password     String
  phone        String   @unique
  gender       Gender
  birthdate    DateTime
  role         Role     @default(CUSTOMER)
  createdAt    DateTime @default(now())
  lastModified DateTime @updatedAt

  @@map("users")
}

model Category {
  // example ID: CAT-12sjc8ky
  id          String  @id @db.VarChar(12)
  name        String
  description String?
  items       Item[]  @relation("ItemVariants")

  @@map("categories")
}

model Item {
  // example ID: VAR-12sjc8ky
  id          String   @id @db.VarChar(12)
  categoryId  String
  name        String
  description String?
  available   Boolean  @default(true)
  category    Category @relation(fields: [categoryId], references: [id], name: "ItemVariants")
  prices      Price[]  @relation("ItemPrices")

  @@map("items")
}

model Price {
  // example ID: PRC-21jid189
  id      String  @id @db.VarChar(12)
  itemId  String
  context Context @default(DINEIN)
  price   Float
  item    Item    @relation(fields: [itemId], references: [id], name: "ItemPrices")

  @@map("prices")
}

enum Role {
  ADMIN
  CUSTOMER
}

enum Gender {
  MALE
  FEMALE
}

enum Context {
  DINEIN
  CATERING
}
